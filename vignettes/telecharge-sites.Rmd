---
title: "Telecharger les sites"
output: rmarkdown::html_vignette
---




```r
library(rcoleo)
library(purrr)

all_taxa <- get_species()
#> Error in get_gen(endpoint, ...): Aucune autorisation détectée! Assurez-vous d'avoir enregistré votre jeton d'accès dans un fichier appelé `.httr-oauth`
all_taxa_df <- map_df(all_taxa[[1]], 1)
#> Error in map(.x, .f, ...): object 'all_taxa' not found
knitr::kable(head(all_taxa_df))
#> Error in head(all_taxa_df): object 'all_taxa_df' not found

dim(all_taxa_df)
#> Error in eval(expr, envir, enclos): object 'all_taxa_df' not found
```



```r
library(rcoleo)
library(purrr)
library(tidyverse)
#> ── Attaching packages ─────────────────────────────────────────────────────────── tidyverse 1.3.0 ──
#> ✓ ggplot2 3.3.2     ✓ readr   1.3.1
#> ✓ tibble  3.0.4     ✓ stringr 1.4.0
#> ✓ tidyr   1.1.2     ✓ forcats 0.5.0
#> Warning: package 'tibble' was built under R version 4.0.2
#> Warning: package 'tidyr' was built under R version 4.0.2
#> ── Conflicts ────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
#> x dplyr::filter() masks stats::filter()
#> x dplyr::lag()    masks stats::lag()

all_sites <- get_sites()
#> Error in get_gen(endpoint, ...): Aucune autorisation détectée! Assurez-vous d'avoir enregistré votre jeton d'accès dans un fichier appelé `.httr-oauth`

# on extract le body
donnees <- all_sites[[1]][[1]]$body
#> Error in eval(expr, envir, enclos): object 'all_sites' not found


pap <-  select(donnees, cell.name, milieu=type, campaigns) %>%
  unnest(campaigns) %>%
  filter(type == "papilionidés")
#> Error in select(donnees, cell.name, milieu = type, campaigns): object 'donnees' not found

knitr::kable(head(pap))
#> Error in head(pap): object 'pap' not found
```

**Is this supposed to work??!**


```r


all_site_pap <- get_obs(site_id = "", type = "papilionidés")
#> Warning in rep(yes, length.out = len): 'x' is NULL so the result will be NULL
#> Error in ans[ypos] <- rep(yes, length.out = len)[ypos]: replacement has length zero

all.equal(one_site_pap[[1]][[1]]$body, all_site_pap[[1]][[1]]$body)
#> Error in all.equal(one_site_pap[[1]][[1]]$body, all_site_pap[[1]][[1]]$body): object 'one_site_pap' not found


pap_df <- all_site_pap %>% map_df(~ .x[[1]][["body"]])
#> Error in eval(lhs, parent, parent): object 'all_site_pap' not found

knitr::kable(pap_df)
#> Error in knitr::kable(pap_df): object 'pap_df' not found

## write.csv(pap_df)
```
