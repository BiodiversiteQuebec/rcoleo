---
title: "Telecharger les sites"
output: rmarkdown::html_vignette
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(rcoleo)
library(purrr)

all_taxa <- get_species()
all_taxa_df <- map_df(all_taxa[[1]], 1)
knitr::kable(head(all_taxa_df))

dim(all_taxa_df)
```


```{r}
library(rcoleo)
library(purrr)
library(tidyverse)

all_sites <- get_sites()

# on extract le body
donnees <- all_sites[[1]][[1]]$body


pap <-  select(donnees, cell.name, milieu=type, campaigns) %>%
  unnest(campaigns) %>%
  filter(type == "papilionidés")

knitr::kable(head(pap))
```

**Is this supposed to work??!**

```{r}


all_site_pap <- get_obs(site_id = "", type = "papilionidés")

all.equal(one_site_pap[[1]][[1]]$body, all_site_pap[[1]][[1]]$body)


pap_df <- all_site_pap %>% map_df(~ .x[[1]][["body"]])

knitr::kable(pap_df)

## write.csv(pap_df)
```
